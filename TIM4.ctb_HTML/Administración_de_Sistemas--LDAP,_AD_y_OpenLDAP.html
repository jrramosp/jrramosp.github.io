<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>LDAP, AD y OpenLDAP</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="../css/styles3.css" type="text/css" />
  <script></script>
</head>
<body><div class="page"><h1 class="title">LDAP, AD y OpenLDAP</h1><br/><a name="h3-1"></a><h3>¿Qué es LDAP?</h3><br />Antes de pasar a los servicios de directorio, hablemos del protocolo subyacente que se usa en los servicios de directorio, llamado LDAP o Protocolo ligero de acceso a directorios. LDAP se usa para acceder a información en servicios de directorio como si fuera a través de una red. Dos de los servicios de directorio más populares que usan LDAP son Active Directory y OpenLDAP.<br />Una entrada LDAP es solo una recopilación de información que se utiliza para describir algo. <br /><a href="https://en.wikipedia.org/wiki/LDAP_Data_Interchange_Format">https://en.wikipedia.org/wiki/LDAP_Data_Interchange_Format</a><br /><a name="h3-2"></a><h3>¿Qué es la autenticación LDAP?</h3><br />Al usar LDAP, hay diferentes niveles de autenticación que se pueden usar para restringir el acceso a ciertos directorios. Ya hablamos de las diferentes operaciones que puedes realizar con LDAP, como agregar, eliminar o modificar entradas en un directorio. Otra operación que puedes realizar es la operación de vinculación, que autentica clientes en el servidor del directorio. Se usará LDAP para verificar si esa cuenta de usuario es un usuario del directorio y si la contraseña es válida. Si lo es, entonces se te concederá acceso a esa cuenta.<br />Hay tres maneras comunes de autenticar. La primera es anónima, luego está la simple y la última es SASL, o capa de autenticación y seguridad simple.<br />La autenticación SASL requiere que el cliente y el servidor de directorio autentiquen mediante algún método. Uno de los métodos más comunes para esta autenticación es Kerberos. Kerberos es un protocolo de autenticación de red que se utiliza para autenticar la identidad del usuario, asegurar la transferencia. de credenciales de usuario, y mucho más.<br /><a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc780469(v=ws.10)?redirectedfrom=MSDN">https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc780469(v=ws.10)?redirectedfrom=MSDN</a><br /><a name="h3-3"></a><h3>Active Directory</h3><br /><a href="https://docs.microsoft.com/es-es/archive/blogs/ashwinexchange/understanding-active-directory-for-beginners-part-1">https://docs.microsoft.com/es-es/archive/blogs/ashwinexchange/understanding-active-directory-for-beginners-part-1</a><br /><a name="h3-4"></a><h3>¿Qué es Active Directory?</h3><br />Active Directory se ha usado para administrar centralmente redes de computadoras desde que se lo presentó con Windows Server 2000. Active Directory trabaja de modo similar a OpenLDAP. Sabe comunicarse usando el protocolo LDAP y puede interoperar con Linux, OS X y otros hosts no Windows que usen ese protocolo.<br />Cuando usas Active Directory para administrar un inventario de servidores Windows y máquinas cliente, AD hace mucho más que proporcionar servicios de directorio y autenticación centralizada. También se convierte en el repositorio central de objetos de directiva de grupo, o GPO, que son una forma de administrar la configuración de las máquinas Windows.<br />Vamos a usar una herramienta llamada Centro de administración de Active Directory, o ADAC.<br />Todo lo que ves en Active Directory es un objeto. Algunos objetos son contenedores que pueden contener otros objetos. Varios de los contenedores predeterminados se llaman, simplemente, contenedores y sirven como ubicaciones predeterminadas para ciertos tipos de objetos. Otro tipo de contenedor se conoce como unidad organizativa (OU), Puedes pensar en una OU como una carpeta o un directorio para organizar objetos dentro de un sistema de administración centralizado. Los contenedores ordinarios no pueden contener otros contenedores, pero las OU pueden contener otras OU.<br />Un dominio tendrá un nombre corto como "example" y un nombre DNS como example.com. A los objetos, en particular las computadoras en el dominio, se les dará un nombre de DNS que resida en la zona DNS del dominio.<br />Un bosque contiene uno o más dominios. Las cuentas pueden compartir recursos entre dominios en el mismo bosque.<br />El servicio que alberga copias de la base de datos de Active Directory se llama controladores de dominio, o DC. Los controladores de dominio proporcionan varios servicios en la red. Albergan una réplica de la base de datos de Active Directory y de los objetos de directiva de grupo. Los DC también sirven como servidores DNS para proporcionar resolución de nombres y detección de servicios a clientes. Ofrecen autenticación central a través de un protocolo de seguridad de red llamado Kerberos. Los controladores de dominio pueden decidir cuándo las computadoras y los usuarios pueden acceder al dominio. También deciden si tienen o no acceso a recursos compartidos, como sistemas de archivos e impresoras.<br />Es común que la mayoría de los controladores de dominio en la red de Active Directory sean réplicas de lectura-escritura. Esto significa que cada una contiene una copia completa de la base de datos de AD y puede hacer cambios en ella. Esos cambios se replican a todas las demás copias de la base de datos en los demás DC. La replicación suele ser rápida y el último cambio prevalece en casi todos los casos.<br />Algunos cambios en la base de datos de AD solo pueden ser hechos de forma segura por un DC a la vez. Asignamos esos cambios a un solo controlador de dominio otorgándole un rol de operaciones de maestro único flexible, también conocido como FSMO.<br />Para que las computadoras aprovechen los servicios especiales de autenticación de AD tienen que estar unidas o vinculadas a Active Directory. Unir una computadora a Active Directory significa dos cosas. Primero, que AD sabe sobre la computadora y que aprovisionó una cuenta de computadora para ella. Segundo, que la computadora sabe sobre el dominio de Active Directory y se autentica con él. De ahí en adelante, la computadora puede autenticar en Active Directory al igual que cualquier usuario que accede a una computadora.<br /><a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc961936(v=technet.10)?redirectedfrom=MSDN">https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc961936(v=technet.10)?redirectedfrom=MSDN</a><br /><a name="h3-5"></a><h3>Gestionar Active Directory</h3><br />Cuando se configura un dominio de Active Directory por primera vez, contiene una cuenta de usuario predeterminada, el administrador, y varios grupos de usuarios predeterminados.<br />Domain admins (Admins. del dominio) son los administradores del dominio de Active Directory. La cuenta Administrator (Administrador) es el único miembro de este grupo en un nuevo dominio. Los usuarios del grupo Domain Admin (Admins. de dominio) pueden hacer los cambios que deseen en el dominio. Como un dominio puede controlar la configuración de todas las computadoras vinculadas a él, los administradores de dominio también pueden convertirse en administradores locales de todas esas máquinas.<br />Enterprise Admins (Administradores de empresas) son administradores del dominio de Active Directory. También tienen permiso para hacer cambios en el dominio que afectan a otros dominios en un bosque multidominio. La cuenta Administrator (Administrador) es el único miembro de este grupo en un nuevo dominio. Las cuentas Enterprise Admin (Administradores de empresas) solo deben ser necesarias en ocasiones particulares, como cuando el bosque de Active Directory se actualiza a una nueva versión.<br />Domain Users (Usuarios del dominio) es un grupo que contiene cada cuenta de usuario en el dominio. Si deseas dar acceso a un recurso de red a todos en el dominio, no es necesario otorgar acceso a cada cuenta individual. Puedes usar Domain Users (Usuarios del dominio).<br />Cada computadora que se une al dominio también tiene una cuenta. Por lo tanto, también tenemos un grupo predeterminado para ellas. Domain Computers (Equipos del dominio) contiene todas las computadoras unidas al dominio, excepto los controladores de dominio.<br />Domain Controllers (Controladores de dominio) contiene todos los controladores de dominio en el dominio.<br />Nunca debes usar una cuenta de administrador de dominio como tu cuenta de usuario diaria. Es muy fácil cometer un error que afecte a toda la organización. Las cuentas de administrador de dominio solo deben usarse cuando tengas que hacer cambios deliberadamente en Active Directory.<br />Tu cuenta de usuario normal debe ser muy parecida a otras cuentas de usuario en el dominio, en la que tus permisos se restringen solo a los recursos a los que necesitas tener acceso todo el tiempo. Si como parte de tu trabajo diario debes realizar algunas tareas administrativas con frecuencia, pero no necesitas tener amplio acceso para hacer cambios en AD, entonces la delegación es para ti. Así como puedes establecer las DACL de NTFS para otorgar permiso a las cuentas en el sistema de archivos, puedes configurar ACL en objetos de Active Directory.<br /><a name="h3-6"></a><h3>Gestionar usuarios y grupos de Active Directory</h3><br />Full name (Nombre completo) es el nombre real de una persona, ¿pero qué es User SamAccountName logon: (Inicio de sesión SamAccountName de usuario:)? Es una manera muy larga de decir nombre de usuario. El Administrador de cuentas de seguridad, o SAM, es una base de datos en Windows que almacena nombres de usuario y contraseñas. De aquí viene SamAccountName.<br />Puedes ver que el dominio será parte del nombre completo de las cuentas. Cada cuenta de usuario debe tener un nombre de usuario único dentro del dominio. <br />Resulta que todo lo que haces en ADAC, en realidad se hace en PowerShell. Abajo, en la parte inferior de la consola, hay un panel de historial de Windows PowerShell que podemos expandir para ver los comandos que está ejecutando ADAC.<br />Crear grupo en ADAC, ¿pero qué son la categoría de grupo y el alcance del grupo? Si volvemos a la ventana del nuevo grupo, verás que hay dos configuraciones obligatorias que dejamos con sus valores predeterminados: Group type (Tipo de grupo) y Group scope (Alcance de grupo). Entonces, ¿qué son? Son dos categorías de grupo en Active Directory. La más común y la única con la que trataremos en este módulo se llama grupo de seguridad. Los grupos de seguridad pueden contener cuentas de usuario, cuentas de computadora o bien otros grupos de seguridad. Los grupos predeterminados, de los que hablamos antes, como los usuarios de dominio y los administradores de dominio, son grupos de seguridad. Se usan para otorgar o denegar el acceso a los recursos de TI.<br />El otro tipo de grupo se llama grupo de distribución. Un grupo de distribución solo está diseñado para agrupar cuentas y contactos para la comunicación por correo electrónico. No se pueden usar grupos de distribución para asignar permisos a los recursos. Una razón por la que podrías usar un grupo de distribución y servir a un grupo de seguridad es crear una lista de correo electrónico que incluya personas fuera de tu dominio.<br />El ámbito del grupo tiene que ver con la forma en que las definiciones de grupo se replican entre dominios. Mantener una gran cantidad de grandes grupos sincronizados en una red muy grande es un problema complicado. Por lo tanto, Active Directory nos brinda diferentes tipos de grupos para administrar esa complejidad.<br />Domain Local (Dominio local). Se usa para asignar permiso a un recurso. Global. Se usa para agrupar cuentas en un rol. Universal. Se usa para agrupar roles globales en un bosque. Los grupos de dominio local y global no se replican fuera del dominio en el que están definidos, pero los grupos universales, sí.<br />Con los grupos de recursos de dominio local y los grupos de roles globales, puedes crear pertenencias grupales muy fáciles de entender. Describen muy claramente qué tipo de acceso se supone que tiene que tener cada rol para cada recurso. <br /><a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc780957(v=ws.10)?redirectedfrom=MSDN">https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2003/cc780957(v=ws.10)?redirectedfrom=MSDN</a><br /><a name="h3-7"></a><h3>Gestión de contraseñas de usuario de Active Directory</h3><br />Una vez que un usuario cambia su contraseña en Active Directory, ese cambio se implementa en todas las máquinas a las que se les permite acceder. Con ciertas excepciones, AD no almacena la contraseña del usuario. En su lugar, almacena un hash criptográfico unidireccional de la contraseña.<br />Como regla general, siempre debes evitar conocer la contraseña de la cuenta de otra persona. Si hay más de una persona que puede autenticar usando el mismo nombre de usuario y contraseña, entonces la auditoría se vuelve difícil o incluso imposible. Auditar tu infraestructura, en este sentido, significa analizar quiénes realizan acciones específicas en tu infraestructura de TI. En una auditoría de seguridad o una situación de solución de problemas, es importante que solo una persona pueda autenticar con su cuenta.<br />El problema más común es que una persona olvida la contraseña. Cuando esto sucede, si tienes responsabilidades de administrador de sistemas, puedes tener autorización para restablecer su contraseña por ellos. Esto solo debe hacerse cuando estés absolutamente seguro de que la persona que solicita el restablecimiento de la contraseña tiene permiso para hacerlo. Muchas organizaciones tendrán políticas y procedimientos que requieren que la solicitud se haga en persona o que la persona, de otro modo, pruebe que es quien dice ser.<br />Active Directory puede bloquear cuentas de usuario si alguien ingresa una contraseña incorrecta para esa cuenta demasiadas veces. Una vez que una cuenta está bloqueada, nadie puede autenticarse hasta que un administrador desbloquee la cuenta. Las políticas de contraseñas de Active Directory controlan cuántos intentos se permiten antes de que una cuenta se bloquee.<br />Si esta persona usó el sistema de encriptación de archivos NTFS o la función EFS para encriptar archivos, puede perder el acceso a esos archivos si se restablece su contraseña.<br /><a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc962100(v=technet.10)?redirectedfrom=MSDN">https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/cc962100(v=technet.10)?redirectedfrom=MSDN</a><br /><a name="h3-8"></a><h3>Unirse a un dominio de Active Directory</h3><br />Unir una computadora a Active Directory significa dos cosas: que AD conoce la computadora y aprovisionó una cuenta de computadora para ella, y que esa computadora conoce el dominio de Active Directory y se autentica con él.<br />Aquí accedí a una computadora con Windows que no está unida al dominio. Esto se denomina una computadora de grupo de trabajo. El nombre proviene de los grupos de trabajo de Windows que son un conjunto de computadoras independientes que trabajan juntas. Los grupos de trabajo de Windows no se administran centralmente, por lo que se vuelven cada vez más difíciles de gestionar a medida que crece el tamaño de la red. Queremos administración y autenticación centralizadas en nuestra red. La computadora puede ser miembro del dominio o del grupo de trabajo, pero no miembro de ambos al mismo tiempo.<br />El controlador de dominio crea una cuenta de computadora en el dominio para esta computadora, y esta computadora se reconfigura para usar los servicios de autenticación de AD. Esto requerirá un reinicio.<br />A lo largo de los años, han habido varias versiones de Active Directory. Nos referimos a estas versiones como niveles funcionales, y el dominio de Active Directory tiene un nivel funcional que describe las características que admite. Si administras Active Directory, tendrás que saber cuáles son sus niveles funcionales de dominio y bosque, y tal vez algún día debas actualizar tu bosque, tus dominios o las nuevas características de Active Directory.<br /><a href="https://docs.microsoft.com/es-es/windows-server/identity/ad-ds/active-directory-functional-levels">https://docs.microsoft.com/es-es/windows-server/identity/ad-ds/active-directory-functional-levels</a><br /><a name="h3-9"></a><h3>¿Qué es la política de grupo?</h3><br />Los servicios de directorio son bases de datos que se usan para almacenar información sobre objetos. Los objetos representan cosas en tu red a las que deseas poder hacer referencia o administrar. Uno de estos tipos de objetos en AD es el objeto de directiva de grupo, o GPO. ¿Qué es un GPO? Es un conjunto de directivas y preferencias que se pueden aplicar a un grupo de objetos en el directorio. Los GPO contienen configuraciones para computadoras y cuentas de usuario.<br />Usar directivas de grupo ayudaría a estandarizar las preferencias de usuario para cada uno de estos equipos y permite que sean más manejables para que las configures. Con las directivas de grupo, puedes crear secuencias de comandos de ingreso y cierre de sesión y aplicarlas a usuarios y computadoras.<br />Puedes crear tantos objetos de directiva de grupo como quieras. Pero no harán nada hasta que estén vinculados a sitios de dominio o unidades organizativas (OU). Cuando vinculas un GPO, todas las computadoras o usuarios en ese dominio, ese sitio o esa OU tendrán esa directiva aplicada. Puedes usar otras herramientas como filtrado de seguridad y filtros WMI para que las directivas de grupo se apliquen de manera más selectiva.<br />Un objeto de directiva de grupo puede contener una configuración de equipo, una configuración de usuario o ambas.<br />La configuración de equipo se aplica cuando la computadora accede al dominio de Active Directory. Esto sucederá cada vez que la computadora se inicie en Windows, a menos que esté desconectada de la red en el momento del inicio. La configuración de usuario se aplica cuando una cuenta de usuario se registra en la computadora. En cada caso, una vez que un GPO está vigente, se lo comprueba y aplica cada pocos minutos.<br />Las directivas son configuraciones que se vuelven a aplicar cada pocos minutos y no se supone que sean modificadas, ni siquiera por los administradores locales. De manera predeterminada, las directivas en el GPO se vuelven a aplicar en la máquina cada 90 minutos. Esto asegura que las computadoras en la red no se desfasen de la configuración que los administradores de sistemas definen para ellas.<br />Las preferencias de directiva de grupo, en cambio, son configuraciones que, en muchos casos, se supone que son una plantilla para la configuración.<br />Los administradores del sistema elegirán la configuración que deba ser la predeterminada en las computadoras que aplican el GPO. Pero alguien que usa la computadora puede cambiar la configuración respecto de lo que se define en la directiva, y ese cambio no será sobrescrito.<br />Cuando una computadora o un usuario unido a un dominio inicia sesión en el dominio por comunicación con un controlador de dominio, ese DC le brinda a la computadora una lista de directivas de grupo que debe aplicar. La computadora luego descarga esas directivas desde una carpeta especial llamada Sysvol, que se exporta como recurso compartido de red desde cada controlador de dominio. Esta carpeta se replica entre todos los controladores de dominio y también puede contener cosas como secuencias de comandos de inicio y cierre de sesión. Una vez que la computadora descargó sus GPO, los aplica.<br />Por último, muchas directivas y preferencias en las GPO se representan como valores en el registro de Windows. El registro de Windows es una base de datos jerárquica de configuraciones que Windows y muchas aplicaciones de Windows utilizan para almacenar datos de configuración. El GPO se aplica mediante cambios en el registro. El sistema operativo Windows y las aplicaciones de Windows leen la configuración del registro para determinar cuál debe ser su comportamiento.<br /><a name="h3-10"></a><h3>Creación y edición de políticas de grupo</h3><br />La herramienta más importante que usaremos para crear y ver objetos de directivas de grupo se llama Consola de administración de directivas de grupo, o GPMC. Puedes encontrarla en el menú de herramientas del Administrador del servidor o ejecutando gpmc.msc desde la línea de comandos.<br />GPMC agrega varios contenedores a su GUI. Estos no son contenedores de AD que todos usamos. Hay interfaces de administración que solo aparecen en GPMC. El contenedor de objetos de directiva de grupo contiene todos los GPO definidos en el dominio. El contenedor de filtros WMI se usa para definir potentes reglas de selección de destino para tus GPO. Estos filtros utilizan propiedades del Instrumental de administración de Windows (WMI) o de objetos WMI para decidir si un GPO debe aplicarse o no a una computadora específica.<br />El resultado de la directiva de grupo es una herramienta de solución de problemas que se usa para averiguar qué directivas de grupo se aplican a la computadora y al usuario en tu red. Usarías esta herramienta para verificar las directivas de grupo que ya se aplican a una computadora o usuario. Por otra parte, el modelado de directivas de grupo se usa para predecir qué directivas de grupo se aplicarán a una computadora o usuario en tu red. Utilizas esta herramienta si deseas probar un cambio en tus GPO, tu uso o tus filtros WMI antes de hacer cambios reales en tu Active Directory.<br />Recuerda que los usuarios y los contenedores informáticos no son unidades organizativas. Los objetos de directiva de grupo solo se pueden vincular a dominios, sitios y OU. Si la computadora y los objetos de usuario están en los contenedores predeterminados, solo se les pueden destinar GPO vinculados a dominios y sitios. Se recomienda que organices tus cuentas de usuario y de computadora en unidades organizativas para que les puedas destinar directivas grupales más específicas.<br />En un nuevo dominio de Active Directory, serán dos GPO los que se crean automáticamente: la directiva de controlador de dominio predeterminada y la directiva de dominio predeterminada. La directiva de dominio predeterminada es, como puedes suponer, un GPO predeterminado que está vinculado al dominio. Se aplica a todas las computadoras y usuarios en el dominio. La directiva de control de dominio predeterminada está vinculada a la OU del control de dominio y se aplica a los controladores de dominio.<br />Las directivas de grupo existen desde hace varias versiones de Windows, y a veces las cosas no están exactamente donde uno esperaría encontrarlas. Algo que podría resultarte muy útil es la referencia a las configuraciones de directivas de grupo que Microsoft publica con cada nueva versión de Windows. Esta referencia es una hoja de cálculo que detalla las directivas y preferencias de GPO que están disponibles, y dónde encontrarlas.<br />Antes de empezar, voy a hacer una copia de seguridad del GPO. Voy a hacer clic derecho en la directiva y elegir Back Up (Hacer copia de seguridad).<br />Volveré a hacer clic derecho en la directiva, voy a elegir Edit (Editar). Esto abrirá la directiva de dominio predeterminada en el Editor de administración de políticas de grupo. Puedes ver en el panel de la izquierda que el GPO se divide en dos secciones: Computer configuration (Configuración del equipo) y User configuration (Configuración del usuario). Cada una de ellas está dividida en directivas y preferencias. Dentro de este árbol de directivas y preferencias está cada configuración de GPO individual que GPMC conoce, haya sido configurada o no. Todos los GPO tienen acceso a la misma configuración. No hay GPO especiales. Aun así, se recomienda hacer diferentes GPO que aborden una categoría específica de necesidad.<br />Con GPO específicos para soluciones específicas, puedes vincularlos solo a la computadora o los usuarios que necesitan esa directiva. Como estás trabajando con todo el universo de directivas de grupo en cada GPO, puede ser muy difícil reconocer desde el editor qué es lo que está verdaderamente configurado en este GPO. Consulta el informe de configuración en el GPMC para obtener esa información. Se ve diferente, pero tal vez notaste que el informe de configuración se presenta de la misma manera jerárquica que el editor de GPO.<br />Cuando debas realizar cambios en una directiva de grupo de producción, deberás probarlos primero. Podría haber sometido a prueba mis cambios. Hay muchas formas de hacer esto. Algunas organizaciones tendrán recomendaciones establecidas para probar modificaciones a los GPO en su entorno.<br />Supongamos que tengo una directiva de GPO llamada "example". Primero, configuro una OU de prueba que contiene máquinas o cuentas de usuario de prueba. Si la directiva de ejemplo suele estar vinculada en example.com, Finance (Finanzas), Computers (Equipos), entonces puedo crear example.com, Finance, Computers, Test (Prueba) y poner máquinas de prueba en la OU de prueba. Esto permite que las máquinas de prueba contengan todos los GPO de producción existentes, pero me ofrece un lugar para vincular un GPO de prueba que sobrescribirá al de producción.<br />A continuación, creo una copia del GPO que deseo modificar y la nombro algo así como Test Example Policy. Ahora puedo hacer los cambios que quiero probar en la directiva de ejemplo de prueba y vincularla a mi OU de prueba. Después de que confirme que mis cambios funcionan de la manera que esperaba, puedo hacer una copia de seguridad de la directiva de prueba y luego importar la copia de seguridad de Test Example Policy a la directiva de ejemplo de producción.<br />Tu organización podría estar usando la Administración avanzada de directivas de grupo, o AGPM, que es un conjunto de herramientas complementarias de Microsoft que te brindan ciertas habilidades de control de aprovisionamiento adicionales en GPMC.<br /><a name="h3-11"></a><h3>Herencia y precedencia de políticas de grupo</h3><br />Los administradores de sistemas son responsables de proteger la seguridad de la infraestructura de TI. Por lo tanto, se recomienda crear un GPO muy restrictivo que use directivas de seguridad conservadoras muy seguras y vincularlo con todo el dominio. Esto te da una directiva predeterminada segura, pero algunos usuarios o computadoras tal vez no puedan hacer lo que deben con esas directivas muy conservadoras.<br />En cualquiera de estos casos, puedes tener computadoras o cuentas de usuario con múltiples GPO asignados a ellos que se contradicen entre sí por diseño. Entonces, ¿qué ocurre cuando hay dos o más objetos de directiva de grupo contradictorios que se aplican al mismo equipo?<br />Cuando las computadoras procesan los objetos de directiva de grupo que se les aplican, todas estas directivas se aplicarán en un orden específico basado en un conjunto de reglas de precedencia. Los GPO se aplican en función de los contenedores que contienen la computadora y la cuenta de usuario. Los GPO que están vinculados al contenedor menos específico o más grande se aplican primero. Los GPO que están vinculados al contenedor más específico o más pequeño se aplican en último lugar. Primero se aplican todos los GPO vinculados en el sitio de AD, luego cualquier vínculo en el dominio y luego cualquier unidad organizativa, de las primarias a las secundarias, en este orden. Si más de una directiva intenta establecer la misma directiva o preferencias, entonces prevalece la directiva más específica.<br />En realidad, puedes vincular varios GPO al mismo contenedor. ¿Cómo decide AD en qué orden aplicar los GPO si hay más de uno en un contenedor? Cada contenedor tiene un orden de vínculos para los GPO vinculados a él. El orden de vínculos de cada política determina qué GPO tiene precedencia. El número más alto es el GPO de menor clasificación, por lo que su configuración se aplica primero. El orden de vínculo con el número más alto en el contenedor menos específico se aplica primero. Y el orden de enlace con el número más bajo en el contenedor más específico es el último GPO que se aplica. El último GPO que modifique cualquier configuración específica es el que prevalece.<br />Cuando agregas todas las políticas de grupo juntas para una máquina específica y les aplicas reglas de precedencia, llamamos a eso el conjunto resultante de directivas, o RSoP, para esa máquina. Cuando estás solucionando problemas de directivas de grupo, a menudo se compara un informe RSoP con lo que esperas que se aplique a esa computadora. Hay muchas maneras de obtener un informe RSoP.<br />Verifiquemos qué objetos de directiva de grupo se aplicarán cuando uno de nuestros empleados de ventas acceda a su computadora, o hagamos clic derecho en el nodo de resultados de la directiva de grupo en GPMC y seleccionemos el Asistente de resultados de la directiva de grupo. Este asistente me guiará a través de la generación de un informe del conjunto resultante de directivas para la computadora y el usuario que yo elija. La computadora que estoy usando para ejecutar este informe establecerá una conexión remota a esa computadora y le pedirá que ejecute el informe. El informe podría verse, entonces, en mi GPMC local. De forma predeterminada, el asistente solo ejecutará un RSoP para la configuración de la computadora.<br />Este informe RSoP contiene todo lo que necesitamos para comprender qué políticas se aplican a una computadora o usuario. Incluye muchísimos detalles sobre dónde se encuentran la computadora y el usuario en AD, a qué grupos de seguridad pertenecen y más. Esto se parece mucho a la información que se ve en la pestaña de configuración de un GPO, pero en lugar de mostrarte solo las configuraciones modificadas por un único GPO, puedes ver el efecto combinado de la aplicación de todos los GPO. La columna Winning GPO (GPO prevalente) te indica qué GPO últimamente tuvo prioridad para cada directiva y preferencia. Si no soy un administrador local en el equipo, no podré ejecutar el informe.<br /><a name="h3-12"></a><h3>Solución de problemas de la política de grupo</h3><br />Uno de los problemas más comunes que puedes encontrar es cuando un usuario no puede acceder a su computadora ni autenticarse en el dominio de Active Directory. Si una computadora de dominio no puede localizar un controlador de dominio que puede usar para la autenticación, entonces nada que dependa de la autenticación de Active Directory funcionará. Podría ser un problema de conectividad de red y nada específico de Active Directory en absoluto. Si la computadora no está conectada a una red que pueda enrutar las comunicaciones al controlador de dominio, entonces esto debe repararse. Cualquier problema de red que impida que la computadora se comunique con el controlador de dominio o sus servidores DNS configurados, los que se usan para encontrar el controlador de dominio, podría ser un inconveniente.<br />Ahora, ¿por qué es tan importante el DNS? Para que la computadora se ponga en contacto con un controlador de dominio, primero necesita encontrar uno. Esto se hace mediante los registros de DNS. La computadora de dominio hará una solicitud de DNS para los registros SRV que coinciden con el dominio al que está vinculada. Si una computadora no puede comunicarse con sus servidores DNS, o si esos servidores DNS no tienen los registros SRV que la computadora está buscando, entonces no podrá encontrar el controlador de dominio.<br />Los registros SRV que nos interesan son _ldap._tcp.dc._msdcs.DOMAIN.NAME, en donde DOMAIN.NAME es el nombre DNS de nuestro dominio. Voy a ir a mi PowerShell, y voy a escribir Resolve-DNSName -Type SRV -Name _ldap._tcp.dc._msdcs.example.com. Se ve bien. Debería ver un registro SRV para cada uno de mis controladores de dominio.<br />Ahora, si no puedo resolver los registros SRV para mis controladores de dominio, entonces mis servidores DNS pueden estar mal configurados. ¿Cómo podrían estar mal configurados? Bueno, mis computadoras de mi dominio deben usar los servidores DNS que alojan mis registros de dominio de Active Directory. Esto será, a menudo, uno o más de mis controladores de dominio, pero puede ser un servidor de dominio diferente. De cualquier manera, los servidores DNS apropiados para que tus computadoras de dominio usen deben ser conocidos y estar documentados. Compara la configuración de la máquina con la buena configuración conocida y fíjate si necesita algún ajuste.<br />Por otra parte, si estás resolviendo algunos registros SRV, pero parecen estar incompletos o incorrectos, entonces puede que necesites resolver problemas en profundidad.<br />Dependiendo de la configuración de tu dominio y tus computadoras, es común que la autenticación local siga funcionando, por un rato, al menos. Una vez que alguien accede a una computadora de dominio, la información requerida para autenticar a ese usuario se copia en la máquina local. Esto significa que después del primer acceso, podrás iniciar sesión en la computadora incluso si la red está desconectada. No te autenticarás en el dominio ni en el acceso autorizado a cualquier recurso de dominio, como carpetas compartidas. Solo porque alguien pueda acceder no significa que puedan encontrar un controlador de dominio.<br />Otro problema que puede impedir que los usuarios se autentiquen tiene que ver con el reloj. Kerberos es el protocolo de autenticación que usa AD, y es sensible a las diferencias de tiempo. No estoy hablando de zonas horarias locales aquí. Me refiero al tiempo UTC relativo. Si el controlador de dominio y la computadora no coinciden con la hora UTC, por lo general en un margen de cinco minutos, entonces el intento de autenticación fallará. Las computadoras de dominio generalmente sincronizan su tiempo con los controladores de dominio mediante el servicio Hora de Windows, pero esto a veces puede fallar. Si la computadora se desconecta de una red de dominio durante demasiado tiempo, o si el software o un administrador local cambian la hora para que no esté sincronizada, entonces la computadora no puede volver a sincronizarse automáticamente con un controlador de dominio. Puedes forzar manualmente a que una computadora de dominio se sincronice de nuevo con el comando w32tm/resync.<br /><a href="https://docs.microsoft.com/es-es/windows-server/networking/windows-time-service/How-the-Windows-Time-Service-Works">https://docs.microsoft.com/es-es/windows-server/networking/windows-time-service/How-the-Windows-Time-Service-Works</a><br /><a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-xp/bb491016(v=technet.10)">https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-xp/bb491016(v=technet.10)</a><br />Un problema común que podrías tener que solucionar es cuando una directiva o una preferencia definidas por el GPO no se aplican a una computadora. El factor común será que algo que creaste para que un GPO configure no se configurará en una o más computadoras.<br />El primer tipo de falla de GPO, y posiblemente el más común, tiene que ver con la forma en que se aplican las directivas de grupo. Según cómo esté configurado tu dominio, el motor de directivas de grupo que aplica la configuración de directivas a una máquina local puede sacrificar la aplicación inmediata de ciertos tipos de directivas para agilizar el acceso. Esto se llama optimización de inicio de sesión rápido, y puede implicar que algunos cambios de GPO tarden mucho más en aplicarse automáticamente de lo que podría esperarse. Además, el motor de directivas de grupo generalmente intenta acelerar una aplicación GPO aplicando los cambios a un solo GPO en lugar de todo el GPO. En cualquiera de estos ejemplos, puedes forzar la aplicación completa e inmediata de todos los GPO con gpupdate/force. Si quieres ser realmente minucioso, puedes ejecutar gpupdate/force/sync. Al agregar el parámetro /sync harás que se cierre la sesión y la computadora se reinicie.<br /><a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc772166(v=ws.11)">https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc772166(v=ws.11)</a><br /><a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/jj134176(v=ws.11)?redirectedfrom=MSDN">https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/jj134176(v=ws.11)?redirectedfrom=MSDN</a><br />Algunos tipos de directivas de grupo solo pueden ejecutarse cuando la computadora se inicia por primera vez o cuando un usuario accede por primera vez. Por lo tanto, cerrar sesión y reiniciar es la única manera de asegurarse de que una actualización forzada a un GPO pueda aplicarse a todas las configuraciones.<br />El error de replicación es otra razón por la que un GPO puede no aplicarse como se esperaba. Recuerda que cuando se realizan cambios en Active Directory, esos cambios habitualmente tienen lugar en un solo controlador de dominio. Esos cambios deben replicarse a otros controladores de dominio. Si la replicación falla, entonces diferentes computadoras en tu red pueden tener diferentes ideas sobre el estado de los objetos de directorio, como los objetos de directiva de grupo. La variable de entorno del servidor de inicio de sesión contendrá el nombre del controlador de dominio que la computadora usó para acceder. Recuerda que puedes ver el contenido de la variable con este comando en PowerShell: $env:LOGONSERVER. También puedes obtener los mismos resultados con %LOGONSERVER% en el símbolo del sistema. Saber a qué control de dominio estás conectado es una información útil si sospechas de un problema de replicación.<br />Desde la consola de administración de directivas de grupo, podemos verificar el estado general de la infraestructura de directivas de grupo. Voy a seleccionar mi dominio y a mirar la pestaña de estado. Esta pestaña resumirá la información de Active Directory y el estado de replicación de Sysvol para el dominio. Puede estar mostrando el resultado de una prueba reciente, así que voy a forzarla a que ejecute un nuevo análisis haciendo clic en Detect Now (Detectar ahora). Lo que queremos ver es que todos nuestros controladores de dominio aparezcan en la sección Domain controller(s) with replication in sync(Controlador[es] de dominio con replicación en sincronización). Si aparecen allí, entonces podemos estar seguros de que no hay problemas de replicación que afecten a nuestros objetos de directiva de grupo. Si vemos algún controlador de dominio en la lista Domain controller(s) with replication in progress (Controlador[es] de dominio con replicación en curso), entonces podemos tener un problema de replicación. Dependiendo del tamaño y la complejidad de tu infraestructura de Active Directory y la confiabilidad y el rendimiento de los enlaces de red entre tus sitios de AD, es posible que una replicación tarde unos minutos en completarse. Si la replicación no se completa en un tiempo razonable, tal vez debas solucionar problemas de replicación de Active Directory.<br /><a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/bb727055(v=technet.10)?redirectedfrom=MSDN">https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-2000-server/bb727055(v=technet.10)?redirectedfrom=MSDN</a><br />Si está tratando de averiguar por qué un GPO en particular no se aplica a una computadora, lo primero que debes hacer es ejecutar el conjunto resultante de directivas, o RSOP. Puedes usar la consola de administración de directivas de grupo, como hicimos en una lección anterior, o puedes ejecutar un comando directo en una computadora para generar el informe. El comando gpresult nos ayudará. Si ejecuto gpresult /R, verás que recibo un informe resumido en mi terminal. Si quiero el informe completo, como el que obtengo de GPMC, puedo ejecutar gpresult /H NOMBRE_DE_ARCHIVO.html. Esto me dará un informe que es una página web HTML que puedo abrir en mi navegador.<br /><a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc733160(v=ws.11)?redirectedfrom=MSDN">https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc733160(v=ws.11)?redirectedfrom=MSDN</a><br />Cada GPO también se puede configurar con el filtro WMI. Un filtro WMI te permite aplicar un GPO según la configuración de la computadora. Los filtros WMI son potentes pero costosos y es fácil cometer errores durante su configuración. Esto es porque miran a los valores del Instrumental de administración de Windows para decidir si una política debe aplicarse o no.<br /><a href="https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc770562(v=ws.11)?redirectedfrom=MSDN">https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc770562(v=ws.11)?redirectedfrom=MSDN</a><br /><a name="h3-13"></a><h3>¿Qué es OpenLDAP?</h3><br />Otro popular servicio de directorio que se usa en la actualidad es el servicio gratuito de código abierto OpenLDAP, que significa protocolo ligero de acceso a directorios y funciona de manera muy similar a Active Directory. Usando notación LDAP o el formato de intercambio de datos LDAP, o LDIF, puedes autenticar, agregar y eliminar usuarios, grupos, computadoras, etc., en un servicio de directorio. OpenLDAP puede usarse en cualquier sistema operativo, incluyendo Linux, macOS, incluso Microsoft Windows.<br />Primero, puedes usar la interfaz de línea de comandos y pasar comandos para crear y administrar las entradas del directorio. También puedes usar una herramienta como phpLDAPadmin, que te ofrece una interfaz web que puedes usar para administrar los datos de tu directorio.<br />Para empezar, abriremos el paquete OpenLDAP con este comando. Voy a entrar a mi entorno de Linux y escribir este comando: sudo apt-get install slapd ldap-utils. Pongo mi contraseña y acepto. Una vez que instales los paquetes, te solicitará que ingreses una contraseña administrativa para LDAP. Ahora que está instalado, vamos a reconfigurar el paquete slapd para que podemos afinar nuestra configuración. sudo dpkg-reconfigure slapd<br /><a href="https://www.digitalocean.com/community/tutorials/how-to-install-and-configure-openldap-and-phpldapadmin-on-ubuntu-16-04">https://www.digitalocean.com/community/tutorials/how-to-install-and-configure-openldap-and-phpldapadmin-on-ubuntu-16-04</a><br /><a href="https://www.openldap.org/doc/admin24/slapdconf2.html">https://www.openldap.org/doc/admin24/slapdconf2.html</a><br /><a name="h3-14"></a><h3>Gestionar OpenLDAP</h3><br />Es fácil administrar OpenLDAP a través de un navegador web y una herramienta como phpLDAPadmin, pero también puedes usar las herramientas de línea de comandos para lograr el mismo resultado.<br />Para comenzar a utilizar las herramientas de línea de comandos, necesitas usar algo que se conoce como archivos LDIF. Es solo un archivo de texto que enumera atributos y valores que describen algo.<br />ldapadd: este toma la entrada de un archivo LDIF y agrega el contexto de los archivos<br />ldapmodify: como puedes suponer, modifica un objeto existente<br />ldapdelete: este eliminará el objeto al que se refiere el archivo LDIF<br />ldapsearch: este buscará entradas en tu base de datos de directorio.<br /><a href="https://en.wikipedia.org/wiki/LDAP_Data_Interchange_Format">https://en.wikipedia.org/wiki/LDAP_Data_Interchange_Format</a><br /><a href="https://www.digitalocean.com/community/tutorials/how-to-use-ldif-files-to-make-changes-to-an-openldap-system">https://www.digitalocean.com/community/tutorials/how-to-use-ldif-files-to-make-changes-to-an-openldap-system</a><p align="center"><img src="images/home.png" height="22" width="22">  <a href="index.html">Índice</a></p></div></body></html>